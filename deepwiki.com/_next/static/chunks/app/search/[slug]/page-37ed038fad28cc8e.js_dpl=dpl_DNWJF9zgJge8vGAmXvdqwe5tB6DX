(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5049],{35070:(e,t,n)=>{Promise.resolve().then(n.bind(n,38340))},38340:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eN});var r=n(95155),a=n(19818),l=n(14656),s=n(68597),i=n(91769),o=n(7805),c=n(45084),d=n(95243),u=n(6874),h=n.n(u),x=n(35695),m=n(12115),p=n(56671),f=n(48335),g=n(53508),b=n(3914),v=n(7050),j=n(14647),y=n(60284),N=n(88106),w=n(19783),k=n(13353),_=n(98223),C=n.n(_),q=n(48730),S=n(82214),E=n(85716),L=n(85807);function A(e){let{path:t,content:n,maxLines:a=10,startLineNumber:l=1,showLineNumbers:s=!1,lineProps:i={},codeStyle:o}=e;return(0,r.jsx)("div",{className:"block h-fit w-full overflow-auto p-0",style:{maxHeight:24*a,scrollbarColor:"rgb(64 64 64) rgb(26, 26, 26)",scrollbarWidth:"thin"},children:(0,r.jsx)(I,{startLineNumber:l,showLineNumbers:s,lineProps:i,content:n,path:t,codeStyle:o})})}function I(e){let{content:t,path:n,startLineNumber:a,showLineNumbers:l,lineProps:s,styles:i={},codeStyle:o}=e;return(0,r.jsx)(S.A,{language:(e=>{var t;let n=null==(t=e.split(":")[0].split(".").pop())?void 0:t.toLowerCase();return n&&L.W[n]||"text"})(n),style:o||E.A,showLineNumbers:l,lineNumberStyle:{fontSize:"11px",fontWeight:"normal",fontFamily:"monospace",minWidth:"2.25em"},startingLineNumber:a,wrapLines:!0,lineProps:s,customStyle:{margin:0,padding:"0px",width:"100%",...i},codeTagProps:{style:{fontSize:"12px"}},children:t||" "})}var F=n(69621),P=n(91308),T=n(52181),D=n(27172);function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth",n=function e(t){return null==t?null:t.scrollHeight>t.clientHeight?t:e(t.parentNode)}(e);n&&n.scrollTo({behavior:t,top:e.getBoundingClientRect().top-n.getBoundingClientRect().top+n.scrollTop-n.getBoundingClientRect().height/2})}function H(e){var t,n,a;let{node:l,allCitations:s,fileByTitle:i,onCustomClick:o,showOnHover:c,...d}=e,[u,h]=(0,k.fp)(T.mG);if((0,m.useEffect)(()=>{let e=e=>{let t=e.target,n=t.closest("button"),r=t.closest("a"),a=t.closest('[role="link"]'),l=t.closest(".clickable-snippet");n||r||a||l||h(null)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[h]),null==(t=d.href)?void 0:t.startsWith("#")){let e=d.href.replace("#",""),t=null==(n=s.find(t=>"".concat(t.queryId,"-").concat(t.citationIndex)===e))?void 0:n.citation;if(!t)return null;let l=t.file_path.match(/Repo ([^:]+): ([^:]+):(\d+)-(\d+)/);if(!l)return null;let[,x,m]=l,p=i["Repo ".concat(x,": ").concat(m)];if(!p)return null;let f=null!=(a=p.file.split("/").at(-1))?a:"",g=(0,r.jsx)("span",{role:"link",tabIndex:0,onClick:()=>{o&&o(),h(e);let t=document.querySelector(".citation-".concat(e));t&&M(t)},className:(0,v.cn)("bg-pacific/10 text-pacific active:bg-pacific/20 hover:bg-pacific/20 cursor-pointer rounded-md px-[0.25rem] py-[0.12rem] text-xs font-normal leading-[15px] transition-colors duration-100 before:hidden after:hidden",u===e&&"bg-pacific/30"),style:C().style,children:"".concat(f,":").concat(t.range_start+1).concat(t.range_start===t.range_end?"":"-".concat(t.range_end+1))});return c?(0,r.jsxs)(w.bL,{delayDuration:100,children:[(0,r.jsx)(w.l9,{asChild:!0,children:g}),(0,r.jsx)(w.ZL,{children:(0,r.jsx)(w.UC,{side:"right",sideOffset:4,className:"z-40 shadow-md shadow-neutral-900",children:c})})]}):g}return(0,r.jsx)("a",{...d})}function R(e){let{content:t,isThinking:n}=e,[a,l]=(0,m.useState)(!1);return((0,m.useEffect)(()=>{l(n)},[n]),0===t.length)?null:(0,r.jsx)(N.Nt,{open:a,onOpenChange:l,children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)(N.R6,{className:"flex w-fit items-center gap-1.5 text-sm text-neutral-300",children:[(0,r.jsx)(y.K,{className:(0,v.cn)("size-4 transition-transform",a&&"rotate-90")}),(0,r.jsx)("span",{className:(0,o.A)(n&&"animate-pulse"),children:n?"Thinking...":"Thought Process"})]}),(0,r.jsx)(N.Ke,{children:(0,r.jsxs)("div",{className:"relative flex flex-col gap-1 text-neutral-400",children:[(0,r.jsx)("div",{className:"absolute left-[7px] top-0 h-full w-[2px] rounded-md bg-neutral-700"}),t.map((e,t)=>(0,r.jsx)("div",{className:"pl-5 text-sm italic",children:e},t))]})})]})})}function z(e){let{onSubmit:t,queryId:n,repoNames:a,onSubmitDevinStart:l,isDeepMode:s,disabled:i}=e,[o,c]=(0,m.useState)(""),d=(0,P.Mc)(),u=async(e,r)=>{await d({query:o,queryId:n,queryDefinition:r?F.Ds.AGENT:F.Ds.MULTIHOP,repoNames:a}),t(),c("")};return(0,r.jsx)(D.B,{selectedRepoNames:a,placeholder:(0,r.jsx)("div",{className:"flex items-center gap-1 overflow-hidden text-nowrap opacity-60",children:"Ask a follow-up question"}),onSubmit:u,prompt:o,setPrompt:c,disabled:i,className:(0,v.cn)("bg-component/70 border border-indigo-300/20 shadow-lg shadow-indigo-500/20 [backdrop-filter:blur(8px)] dark:[backdrop-filter:blur(8px)_contrast(90%)_brightness(60%)]"),showRows:2,animate:!0,allowCreateDevin:!0,onCmdSubmit:()=>{l(o)},isDeep:s})}function O(e){let{onClick:t,text:n="Go deeper"}=e;return(0,r.jsxs)("button",{onClick:t,className:"flex min-w-max cursor-pointer items-center gap-1.5 whitespace-nowrap rounded-md bg-[#ef9541]/10 px-3 py-1.5 text-sm text-[#ef9541] transition-colors hover:bg-[#ef9541]/20 dark:bg-[#FFD700]/10 dark:text-[#FFD700] dark:hover:bg-[#FFD700]/20",children:[(0,r.jsx)(l.j,{className:"h-4 w-4"}),n]})}function W(e){let{file:t,contents:n,i:a,scanned:l}=e,[s,i]=(0,m.useState)(!1);return(0,r.jsxs)(N.Nt,{open:s,onOpenChange:i,disabled:!l,children:[(0,r.jsx)(N.R6,{className:"w-full",children:(0,r.jsxs)(d.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"flex items-center gap-2 text-sm text-neutral-300",children:[(0,r.jsx)(y.K,{className:(0,v.cn)("size-4 transition-transform",s&&"rotate-90")}),(0,r.jsxs)("div",{className:"truncate",children:[l?"Scanned":"Scanning"," ",t.split("/").pop()]}),(0,r.jsx)(d.P.div,{initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.1*a,duration:.5},className:"h-[2px] flex-1 bg-neutral-200 dark:bg-neutral-700"})]})}),(0,r.jsx)(N.Ke,{children:l&&(0,r.jsx)("div",{className:"mt-2 overflow-hidden rounded-sm bg-[rgb(26_26_26)] pl-4 pt-1.5",children:(0,r.jsx)(A,{showLineNumbers:!0,startLineNumber:1,content:n,maxLines:10,path:t})})})]})}let G=(0,m.memo)(function(e){let{rows:t,className:n,padding:a=0}=e;return(0,r.jsx)("div",{className:(0,v.cn)("animate-shimmer flex flex-col rounded-lg",n),style:{height:16*t+(t>1?t-1:0)*8+4*a*2}})}),B=(0,m.memo)(function(e){let{rows:t,delay:n=0,className:a="bg-primary/5",pulsate:l=!0}=e;return Array.from({length:t},(e,t)=>t).map(e=>(0,r.jsx)(d.P.div,{initial:{width:"0%"},animate:{width:"".concat(Math.floor(51*Math.random()+50),"%")},transition:{duration:1,delay:n+.1*e,ease:"easeOut"},className:(0,v.cn)("h-4 rounded-full",l&&"animate-pulse",a)},e))});function K(e){let{text:t,header:n,href:a,id:l}=e,s=t.length>200,[i,o]=(0,m.useState)(!1),c=()=>{let e=window.location.href.split("#")[0];(0,j.l)(e+"#".concat(l))};return(0,r.jsxs)("div",{className:"flex flex-col items-start gap-2 text-white",children:[n&&(0,r.jsx)("span",{className:"text-sm text-neutral-400",children:n}),!s&&(0,r.jsx)("div",{className:"group relative flex items-center",children:(0,r.jsxs)("span",{className:(0,v.cn)(t.length>100?"text-lg xl:text-xl":"text-xl xl:text-2xl",a?"cursor-pointer hover:underline":""),children:[a?(0,r.jsx)("a",{title:"Open in new tab",href:a,target:"_blank",rel:"noopener noreferrer",children:t}):t,(0,r.jsx)(q.D,{onCopyLink:c,label:"Copy link to query"},"copy-btn")]})}),s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"group relative flex items-center",children:(0,r.jsxs)("span",{className:(0,v.cn)("text-base xl:text-lg",a?"cursor-pointer hover:underline":""),style:{overflowWrap:"anywhere"},children:[a?(0,r.jsxs)("a",{title:"Open in new tab",href:a,target:"_blank",rel:"noopener noreferrer",children:[t.substring(0,200),"..."]}):(0,r.jsxs)(r.Fragment,{children:[t.substring(0,200),"..."]}),(0,r.jsx)(q.D,{onCopyLink:c,label:"Copy link to query"})]})}),(0,r.jsx)("button",{className:"text-sm text-neutral-400 underline",onClick:()=>o(!i),children:i?"Hide full text":"Show full text"}),i&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("span",{className:"text-sm text-neutral-400",style:{overflowWrap:"anywhere"},children:t})})]})]})}function Q(e){let{isLastQuery:t}=e;return(0,r.jsx)(U,{id:"1",prompt:(0,r.jsx)(G,{className:"rounded-lg [--c-1:#f1f1f1] [--c-2:var(--bg-secondary)] dark:[--c-1:#131313] dark:[--c-2:#141414]",padding:1,rows:2}),searchedRepos:(0,r.jsx)(G,{className:"w-3/4 rounded-lg [--c-1:#f1f1f1] [--c-2:var(--bg-secondary)] dark:[--c-1:#131313] dark:[--c-2:#141414]",rows:1.5}),leftPane:(0,r.jsx)(G,{className:"[--c-1:#f5f5f5] [--c-2:#eeeeee] dark:[--c-1:#141414] dark:[--c-2:#161616]",padding:4,rows:5}),rightPane:(0,r.jsx)(G,{padding:4,className:"[--c-1:#f5f5f5] [--c-2:#eeeeee] dark:[--c-1:#141414] dark:[--c-2:#161616]",rows:20}),isLastQuery:t})}function U(e){let{id:t,prompt:n,searchedRepos:a,leftPane:l,rightPane:s,isLastQuery:i}=e;return(0,m.useEffect)(()=>{window.location.hash.substring(1)===t&&setTimeout(()=>{let e=document.getElementById(t);e&&e.scrollIntoView({block:"start"})},100)},[t]),(0,r.jsxs)("div",{id:t,className:"flex flex-col gap-3 pt-8 lg:flex-row","data-query-display":!0,children:[(0,r.jsx)("div",{className:"flex max-h-fit min-w-0 flex-1 flex-shrink-0 flex-col xl:[flex-grow:2]",children:(0,r.jsxs)("div",{className:"",children:[n,(0,r.jsx)("div",{className:"py-3",children:a}),(0,r.jsx)("div",{className:"h-fit rounded-lg",style:{scrollbarWidth:"thin",scrollbarColor:"rgb(58 58 58 / 1) transparent"},children:l})]})}),(0,r.jsx)(d.P.div,{initial:{minHeight:"calc(100vh - 205px)"},animate:i?{minHeight:"calc(100vh - 205px)"}:{minHeight:"unset"},className:"min-w-0 flex-1 scroll-smooth xl:[flex-grow:3]",style:{scrollbarWidth:"thin",scrollbarColor:"rgb(90 90 90) transparent"},children:(0,r.jsx)("div",{style:{maxHeight:i?"calc(100vh - 145px)":"calc(100vh - 55px)"},className:"sticky left-0 top-0 overflow-y-auto rounded-md",children:s})})]})}var V=n(18189),X=n(66965),$=n(72848),Y=n(20833),J=n(9506);function Z(e){let{content:t,startLineNumber:n,path:a,onClick:l,isHighlighted:s=!1,citationKeys:i=null,className:o="",bgColor:c}=e,d=(0,k.md)(T.mG),u=(0,J.D)().resolvedTheme;return(0,r.jsx)("div",{className:(0,v.cn)("relative w-full min-w-max overflow-hidden [&_pre]:overflow-hidden",o,l&&"clickable-snippet cursor-pointer"),onClick:l,children:(0,r.jsx)(I,{showLineNumbers:!0,startLineNumber:n,lineProps:()=>({style:{backgroundColor:s&&null!==i&&d&&i.includes(d)?"color-mix(in oklab, var(--color-pacific) 30%, transparent)":s?"dark"===u?"#363636":"var(--bg-secondary)":"dark"===u?c:"#f8f8f8",display:"block",whiteSpace:"pre",padding:"0px 20px"}}),content:t,path:a,codeStyle:"dark"===u?E.A:Y.A})})}var ee=n(29205),et=n(59507);function en(e){var t;let{file:n,commitHash:a,filePath:l,isWholeFileCollapsed:s,onToggleWholeFileCollapse:i,rounded:c=!0,collapsible:d=!0}=e,u=(0,L.A)(null!=(t=l.split("/").pop())?t:"");return(0,r.jsx)("div",{className:(0,o.A)("bg-secondary dark:bg-surface sticky top-0 z-10 flex w-full items-center justify-between px-3 py-1.5 text-sm text-neutral-300",c&&"rounded-t-sm"),children:(0,r.jsxs)("div",{className:"flex min-w-0 grow items-center gap-2",children:[d&&(0,r.jsx)("button",{onClick:i,children:s?(0,r.jsx)(y.K,{className:"h-3 w-3"}):(0,r.jsx)(ee.a,{className:"h-3 w-3"})}),(0,r.jsx)(u,{className:"size-4 flex-shrink-0"}),n.repo&&(0,r.jsx)("a",{href:n.repo.split("/").length<=2?"https://github.com/".concat(n.repo):"https://".concat(n.repo),target:"_blank",rel:"noreferrer",className:"cursor-pointer truncate text-neutral-500 hover:underline",children:n.repo}),(0,r.jsx)("a",{href:n.repo&&(n.repo.split("/").length<=2?"https://github.com/".concat(n.repo,"/blob/").concat(a,"/").concat(l):"https://".concat(n.repo,"/-/blob/").concat(a,"/").concat(l)),target:"_blank",rel:"noreferrer",className:(0,o.A)("cursor-pointer truncate text-black dark:text-neutral-300",n.repo&&"hover:underline"),children:l}),(0,r.jsx)("button",{onClick:()=>{(0,j.l)(l),p.oR.success("Copied to clipboard")},children:(0,r.jsx)(et.Q,{className:"h-4 w-4 text-neutral-500"})})]})})}function er(e,t){return[...e].sort((e,n)=>{let r="function"==typeof t?t(e):e[t],a="function"==typeof t?t(n):n[t];return r<a?-1:+(r>a)})}let ea=e=>e.reduce((e,t)=>{if("citation"===t.type){let n=t.citation.file_path.replace(/:(\d+)-(\d+)$/,""),r=e.find(e=>{let[r,a]=e;return r===n&&a===t.type});r&&r[1]===t.type?r[2].push(t):e.push([n,t.type,[t]])}return e},[]);function el(e){let{fileByTitle:t,citations:n,rounded:a=!0,behavior:l,commitHash:s}=e,i=(0,m.useMemo)(()=>ea(n),[n]);return(0,r.jsx)(r.Fragment,{children:i.map(e=>{let[n,i,o]=e;return"citation"===i?(0,r.jsx)(ed,{fileByTitle:t,fileKey:n,citations:o,rounded:a,behavior:l,commitHash:s},n):null})})}let es={up:V.$,down:X.K,vertical:$.z};function ei(e){let{icon:t,onClick:n}=e,a=es[t];return(0,r.jsx)("button",{onClick:n,className:"h-5 w-full cursor-pointer bg-[#f0f0f0] hover:bg-[#e0e0e0] dark:bg-neutral-800 dark:hover:bg-neutral-700/80",children:(0,r.jsx)("div",{className:"flex h-full items-center gap-1.5 pl-[1.3rem] text-xs font-light text-neutral-400",children:(0,r.jsx)(a,{className:"h-3 w-3"})})})}function eo(e){let{fileLines:t,startLine:n,endLine:a,filePath:l}=e;return(0,r.jsx)(Z,{content:t.slice(n,a+1).join("\n"),startLineNumber:n+1,path:l,className:"bg-neutral-800/80"})}function ec(e){let{citation:t,fileLines:n,filePath:a,citationKeys:l,setActiveCitationKey:s}=e;return(0,r.jsx)("div",{className:l.map(e=>"citation-".concat(e)).join(" "),children:(0,r.jsx)(Z,{content:n.slice(t.range_start,t.range_end+1).join("\n"),startLineNumber:t.range_start+1,path:a,isHighlighted:!0,citationKeys:l,className:"bg-[#6096FF]/10",onClick:()=>{s(l[0])}})})}function ed(e){let{fileKey:t,citations:n,fileByTitle:a,rounded:l=!0,behavior:s,collapsible:i=!0,commitHash:c}=e,[d,u]=(0,m.useState)(!1),h=a[t],[x,p]=(0,k.fp)(T.mG),[f,g]=(0,m.useState)([]),b=(0,m.useMemo)(()=>{let e=null==h?void 0:h.file;if(!e)return[];let t=h.contents.split("\n"),a=[...n].sort((e,t)=>e.citation.range_start-t.citation.range_start).reduce((e,t)=>{let n=e[e.length-1];if(n&&t.citation.range_start<=n.citation.range_end){var r;let a={...n,children:[...null!=(r=n.children)?r:[],t]};return t.citation.range_end>n.citation.range_end&&(a.citation={...n.citation,range_end:t.citation.range_end}),[...e.slice(0,-1),a]}return e.push(t),e},[]),l=[],s=[],i=[];a.forEach((n,o)=>{var c,d,u,h,x;let m=null!=(u=null==(c=a[o+1])?void 0:c.citation.range_start)?u:t.length,f=null!=(h=null==(d=a[o-1])?void 0:d.citation.range_end)?h:-1;l.push({lineNumber:n.citation.range_start,element:(0,r.jsx)(ec,{citation:n.citation,fileLines:t,filePath:e,citationKeys:[n,...null!=(x=n.children)?x:[]].map(e=>"".concat(e.queryId,"-").concat(e.citationIndex)),setActiveCitationKey:p})}),i.push([n.citation.range_start,n.citation.range_end]),s.push([Math.max(f+1,n.citation.range_start-3),n.citation.range_start-1]),s.push([n.citation.range_end+1,Math.min(m-1,n.citation.range_end+3)])});let o=e=>er(e,e=>e[0]).reduce((e,t)=>{var n;let[r,a]=t;return r>a||((null==(n=e[e.length-1])?void 0:n[1])+1>=r?e[e.length-1][1]=Math.max(e[e.length-1][1],a):e.push([r,a])),e},[]),c=o(s.concat(f));for(let[n,a]of c)l.push({lineNumber:Math.max(0,n),element:(0,r.jsx)(eo,{fileLines:t,startLine:Math.max(0,n),endLine:Math.min(t.length-1,a),filePath:e})});let d=o([...c,...i]);return d.forEach((e,n)=>{var a,s;let[i,o]=e,c=null==(a=d[n+1])?void 0:a[0],u=null==(s=d[n-1])?void 0:s[1];i>0&&(void 0===u||i-15>u)&&l.push({lineNumber:i-1,element:(0,r.jsx)(ei,{icon:"up",onClick:()=>{g([...f,[i-15,i-1]])}})}),o<t.length-1&&(c&&c<o+15?l.push({lineNumber:o+1,element:(0,r.jsx)(ei,{icon:"vertical",onClick:()=>{g([...f,[o+1,c-1]])}})}):l.push({lineNumber:o+1,element:(0,r.jsx)(ei,{icon:"down",onClick:()=>{g([...f,[o+1,o+15]])}})}))}),er(l,e=>e.lineNumber)},[h,n,f]);return((0,m.useEffect)(()=>{if(null!==x){let e=document.querySelector(".citation-".concat(x));e&&M(e,s)}},[x]),h)?(0,r.jsx)("div",{id:"file-".concat(t),className:(0,o.A)("flex flex-col gap-2 scroll-smooth",l&&"rounded-md"),style:{contentVisibility:"auto"},children:(0,r.jsxs)("div",{className:(0,o.A)("scrollbar-hide relative w-full p-0 ring-1 ring-neutral-800",l&&"rounded-sm"),children:[(0,r.jsx)(en,{file:h,commitHash:c,rounded:l,filePath:h.file,isWholeFileCollapsed:d,onToggleWholeFileCollapse:()=>u(e=>!e),collapsible:i}),!d&&(0,r.jsx)("div",{className:"scrollbar-hide grid overflow-auto scroll-smooth",children:b.map(e=>{let{lineNumber:t,element:n}=e;return(0,r.jsx)(m.Fragment,{children:n},t)})})]})}):null}var eu=n(84312),eh=n(90061);let ex=e=>e.replace(/ATTACHMENT:([^\n]*)?"(https:\/\/(?:api\.devin\.ai|files\.(?:staging\.)?devinusercontent\.com|preview\.devin\.ai|app\.devin\.ai|staging\.itsdev\.in|dev\.itsdev\.in)\/attachments\/[^\s/]+\/[^\s/]+)"/g,(e,t,n)=>"("+(n.split("/").pop()||n)+")"),em=e=>{let t=e.includes("<relevant_context>")&&e.includes("</relevant_context>");if(e=ex(e),!t)return e;let n=e.indexOf("<relevant_context>"),r=e.lastIndexOf("</relevant_context>");return e.slice(0,n)+e.slice(r+19)},ep=e=>{let t=e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"-").slice(0,30).replace(/-+$/,""),n=crypto.randomUUID();return"".concat(t,"_").concat(n)};function ef(e){var t,n,a,l,s,o,c;let{id:d}=e,u=(0,x.useRouter)(),h=(0,i.I)(eu.j.queryItem(d)),p=null!=(c=null==(n=h.data)||null==(t=n.queries[0])?void 0:t.repo_names)?c:null==(s=h.data)||null==(l=s.queries[0])||null==(a=l.repo_context_ids)?void 0:a.map(eh.C5);(0,m.useEffect)(()=>{"error"===h.status&&u.replace("/search")},[h.status,u]);let f=null==(o=h.data)?void 0:o.queries.at(-1),[b,v]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{try{let e=JSON.parse(localStorage.getItem("user_query_history")||"[]");v(e.some(e=>e.id===d))}catch(e){console.error("Error parsing query history:",e),v(!1)}},[d]),(0,r.jsxs)("div",{className:"flex min-h-full w-full flex-col scroll-smooth text-[#cbcbcb]",style:{scrollbarGutter:"stable"},children:[(0,r.jsx)(g.CodebaseWikiHeader,{}),h.data&&h.data.queries.length>1&&(0,r.jsx)(eg,{queries:h.data.queries.map(e=>e.user_query)}),(0,r.jsx)("div",{className:"container-wrapper flex-1",children:(0,r.jsxs)("div",{className:"container relative mx-auto",children:[(0,r.jsx)("div",{className:"pb-36",children:h.isSuccess?h.data.queries.map((e,t)=>(0,r.jsxs)(m.Fragment,{children:[(0,r.jsx)(eb,{repoNames:null!=p?p:[],query:e,queryId:t,isFirstQuery:0===t,isLastQuery:t===h.data.queries.length-1}),t!==h.data.queries.length-1&&(0,r.jsx)("div",{className:"mb-8 mt-16 h-px w-full bg-neutral-300 dark:bg-neutral-700"})]},t)):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(Q,{isLastQuery:!0})})}),b&&(0,r.jsx)("div",{className:"pointer-events-none fixed bottom-2 left-2 right-2 mt-2 md:bottom-4 md:left-0 md:right-0",children:(0,r.jsx)("div",{className:"z-10 mx-auto max-w-3xl",children:(0,r.jsx)(z,{queryId:d,disabled:h.isLoading||(null==f?void 0:f.state)!=="done",repoNames:null!=p?p:[],isDeepMode:(null==f?void 0:f.engine_id)===F.Ds.AGENT.engine_id,onSubmit:()=>{setTimeout(()=>{let e=Array.from(document.querySelectorAll("[data-query-display]")).at(-1);e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)},onSubmitDevinStart:async()=>{}})})})]})})]})}function eg(e){let{queries:t}=e,[n,a]=(0,m.useState)(!1),[l,s]=(0,m.useState)(t.length-1);(0,m.useEffect)(()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&s(parseInt(e.target.getAttribute("data-query-index")||"0"))})},{root:null,rootMargin:"-50% 0px",threshold:0}),t=document.querySelectorAll("[data-query-display]");return t.forEach((t,n)=>{t.setAttribute("data-query-index",n.toString()),e.observe(t)}),()=>{t.forEach(t=>e.unobserve(t))}},[t.length]);let i=e=>{let t=document.querySelectorAll("[data-query-display]")[e];t&&t.scrollIntoView({behavior:"smooth",block:"start"})};return(0,r.jsx)("div",{className:"absolute right-2 top-[50%] z-20 -translate-y-1/2 lg:block xl:right-8 2xl:right-12",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.N,{children:n&&(0,r.jsx)(d.P.div,{initial:{opacity:0,x:10},onHoverStart:()=>a(!0),onHoverEnd:()=>a(!1),animate:{opacity:+!!n,x:10*!n},transformTemplate:e=>"translateX(".concat(e.x,") translateY(-50%)"),exit:{opacity:0,x:10},className:"absolute right-0 top-1/2 flex min-w-[200px] max-w-[250px] -translate-y-1/2 flex-col rounded-lg bg-neutral-800 p-4 shadow-md ring-1 ring-neutral-700",children:t.map((e,t)=>(0,r.jsx)("div",{onClick:()=>i(t),className:(0,v.cn)("cursor-pointer truncate text-nowrap rounded-sm bg-neutral-800 px-1.5 py-1 text-sm transition-colors hover:bg-neutral-700/50 hover:text-neutral-200",t===l?"text-pacific hover:text-pacific":"text-neutral-400"),children:e},t))})}),(0,r.jsx)(d.P.div,{onHoverStart:()=>a(!0),onHoverEnd:()=>a(!1),className:"flex flex-col gap-3 px-1 py-4",transition:{duration:.2},children:t.map((e,t)=>(0,r.jsx)(d.P.div,{onClick:()=>i(t),className:(0,v.cn)("h-0.5 w-4 cursor-pointer rounded-full shadow-sm transition-colors",t===l?"bg-white shadow-white/70":"bg-neutral-400 shadow-neutral-400/70")},t))})]})})}function eb(e){var t,n,i,c,d;let{query:u,repoNames:x,queryId:g,isFirstQuery:j,isLastQuery:y}=e,N=(0,P.Mc)(),w=async()=>{if(u.user_query)try{let e=ep(u.user_query);await N({query:u.user_query,queryDefinition:F.Ds.AGENT,repoNames:x||[],noStreamResult:!0,queryId:e}),window.open("/search/".concat(e),"_blank")}catch(e){console.error("Error creating deep query:",e),p.oR.error("Failed to start deep search. Please try again.")}},k=u.user_query,_=null!=(c=null==(n=u.repo_context_ids)||null==(t=n.at(0))?void 0:t.split("/").at(-1))?c:"",C=(0,m.useMemo)(()=>({state:"done"===u.state?"complete":"pending"===u.state?"loading":"error",resourceContents:u.response.filter(e=>"file_contents"===e.type).map(e=>e.data),messageChunks:u.response.filter(e=>"reference"===e.type||"chunk"===e.type||"loading_indexes"===e.type).map(e=>"chunk"===e.type?{...e,type:"text"}:e),error:u.error?u.error[1]:void 0,stats:{}}),[u]),q=null!=(d=null==(i=C.messageChunks)?void 0:i.filter(e=>"reference"===e.type))?d:[],S=(0,m.useMemo)(()=>{var e,t;return null!=(t=null==(e=C.resourceContents)?void 0:e.filter(eh.Uf))?t:[]},[C.resourceContents]),E=(0,m.useMemo)(()=>{var e;return Object.fromEntries(null!=(e=S.map(e=>{let[t,n,r]=e;return["Repo ".concat(t,": ").concat(n),{repo:t,file:n,contents:r}]}))?e:[])},[S]),{allCitations:L,markdownContent:A,thinkingContent:I}=(0,m.useMemo)(()=>{var e;let t=!0,n=[],r=(e,t)=>"file_path"in e&&"file_path"in t?e.file_path===t.file_path&&e.range_start===t.range_start&&e.range_end===t.range_end:"note_id"in e&&"note_id"in t&&e.note_id===t.note_id&&e.range_start===t.range_start&&e.range_end===t.range_end,a=0,l="";for(let s of null!=(e=C.messageChunks)?e:[])if("text"===s.type&&(l+=s.data),"loading_indexes"===s.type&&(t=s.data.all_done),"reference"===s.type){let e=n.find(e=>r(e.citation,s.data));if(e){if("file_path"in s.data){let t={type:"citation",citation:s.data,originalPosition:l.length,citationIndex:e.citationIndex,queryId:g};l=l.trimEnd()+" [".concat(t.citationIndex+1,"](#").concat(t.queryId,"-").concat(t.citationIndex,") "),n.push(t)}}else if("file_path"in s.data){let e={type:"citation",citation:s.data,originalPosition:l.length,citationIndex:a++,queryId:g};l=l.trimEnd()+" [".concat(e.citationIndex+1,"](#").concat(e.queryId,"-").concat(e.citationIndex,") "),n.push(e)}}let s=l.split("\n> Searching codebase...\n");return{allCitations:n,thinkingContent:s.slice(0,-1),markdownContent:s[s.length-1],indexesAreLoaded:t}},[C.messageChunks,C.state,g]),T=(0,m.useMemo)(()=>({a:e=>(0,r.jsx)(H,{allCitations:L,fileByTitle:E,...e})}),[E,L]),D=(0,m.useMemo)(()=>{var e,t;return null!=(t=null==(e=C.resourceContents)?void 0:e.map(e=>{let[,t,n]=e;return{type:"file_contents",key:t,title:t,contents:n}}))?t:[]},[C.resourceContents]),M="loading"===C.state,z=x[0];return!z||x.length>1?null:(0,r.jsx)(U,{id:"".concat(g+1),prompt:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)(h(),{href:"/".concat(z),className:"flex items-center gap-2 text-base text-neutral-400 transition-colors hover:text-black dark:hover:text-white",children:[(0,r.jsx)(a.n,{size:20,weight:"regular"}),"return to ",z]}),(0,r.jsx)(K,{id:"".concat(g+1),text:em(k)})]}),searchedRepos:(0,r.jsxs)("div",{className:"text-primary/70 flex flex-col items-start justify-between text-sm",children:[(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsx)("div",{className:(0,v.cn)("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium",u.engine_id===F.Ds.AGENT.engine_id?"bg-[#ef9541]/20 text-[#ef9541]":"text-neutral-400"),children:u.engine_id===F.Ds.AGENT.engine_id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.j,{className:"mr-1",size:12,weight:"fill"}),"Deep"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.l,{className:"mr-1",size:12,weight:"fill"}),"Fast"]})})}),(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:(0,v.cn)(M&&"animate-pulse"),children:"".concat(M?"Searching":"Searched"," across ").concat(z).concat(M?"...":"")}),u.engine_id!==F.Ds.AGENT.engine_id&&j&&(0,r.jsx)("div",{children:(0,r.jsx)(O,{onClick:w})})]}),"error"===C.state&&(0,r.jsx)("div",{className:"mt-4 w-full rounded-md bg-red-500/10 px-3 py-2 text-red-500",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("span",{className:"font-medium",children:"Error:"}),(0,r.jsx)("span",{children:u.error&&"rate_limit_exceeded"===u.error[1]?"You've reached the maximum number of queries allowed. Please try again later.":"An error occurred while running the query, please contact support"})]})})]}),isLastQuery:y,leftPane:A.length||I.length?(0,r.jsxs)("div",{className:"dark:[&_pre:has(code)]:bg-shade dark:[&_code[data-lang]]:bg-shade relative flex flex-col gap-1 rounded-md border-[0.5px] border-[#d0d0d0] bg-[#f8f8f8] p-4 text-white [overflow-wrap:anywhere] dark:border-[#2F2F2F] dark:bg-[#141414] [&_pre]:my-3",children:[(!u.engine_id||u.engine_id===F.Ds.AGENT.engine_id)&&(0,r.jsx)(R,{content:I,isThinking:0===A.trim().length}),(0,r.jsx)(f.o,{contents:A.replace(/\n/gi,"  \n").replace(/```\s+\[/g,"```\n["),id:"query-".concat(g),externalComponents:T,isAda:!0}),(0,r.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,r.jsx)(ev,{content:A}),(0,r.jsx)(b.w,{})]})]}):(0,r.jsx)("div",{className:"rounded-md bg-[#f0f0f0] p-4 dark:bg-[#141414]",children:(0,r.jsx)("div",{className:"flex animate-pulse flex-col gap-2",children:(0,r.jsx)(B,{className:"bg-[#e0e0e0] dark:bg-[#242424]",rows:5,pulsate:!1})})}),rightPane:q.length>0?(0,r.jsx)("div",{className:(0,o.A)("flex flex-col gap-3 p-0",y?"":"pb-[90px]"),children:(0,r.jsx)(el,{fileByTitle:E,citations:L,commitHash:_})}):D.length>0?(0,r.jsx)("div",{className:"flex flex-col gap-2 rounded-md border-[0.5px] border-[#d0d0d0] bg-[#f8f8f8] p-3 dark:border-[#2f2f2f] dark:bg-[#141414]",children:D.map((e,t)=>{let{key:n,title:a,contents:l}=e;return(0,r.jsx)(W,{scanned:"complete"===C.state,file:a,contents:l,i:t},n)})}):(0,r.jsx)("div",{className:"flex flex-col gap-2 rounded-md bg-[#f0f0f0] p-4 dark:bg-[#141414]",children:(0,r.jsx)(B,{rows:20,className:"bg-[#e0e0e0] dark:bg-[#242424]"})})})}function ev(e){let{content:t}=e,[n,a]=(0,m.useState)(!1);return(0,r.jsx)("button",{onClick:()=>{(0,j.l)(t),a(!0),setTimeout(()=>{a(!1)},2e3)},className:"border-border hover:border-border-hover bg-surface hover:border-border-hover hover:bg-component flex cursor-pointer items-center gap-1.5 rounded-md border px-3 py-1.5 text-sm font-medium text-white transition-all","aria-label":"Copy Response",children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ey,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Copied"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ej,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Copy Response"})]})})}function ej(e){let{className:t}=e;return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15V5a2 2 0 0 1 2-2h8"})]})}function ey(e){let{className:t}=e;return(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:(0,r.jsx)("polyline",{points:"20 6 9 17 4 12"})})}function eN(e){let{params:t}=e,{slug:n}=(0,m.use)(t);return(0,r.jsx)(ef,{id:n})}}},e=>{var t=t=>e(e.s=t);e.O(0,[7474,9453,8970,1585,4129,2545,537,5009,2136,3377,6671,9970,1235,4889,168,9853,5313,7646,5058,8335,1915,8441,1684,7358],()=>t(35070)),_N_E=e.O()}]);