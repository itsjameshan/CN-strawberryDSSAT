#!/usr/bin/env python3
"""
Pythonä¸DSSATæ¨¡å‹è¡Œæ•°å·®å¼‚çš„ç®€å•è§£é‡Š
Simple explanation of why Python and DSSAT models have different row counts.
"""

import os
import pandas as pd

def main():
    # ==================== æ‰“å°æ ‡é¢˜éƒ¨åˆ† ====================
    print("=" * 80)
    print("ä¸ºä»€ä¹ˆä¸¤ç§æ¨¡å‹çš„è¡Œæ•°ä¸åŒï¼Ÿ")
    print("=" * 80)
    print()
    
    # ==================== æ ¸å¿ƒå·®å¼‚è¯´æ˜ ====================
    print("ğŸ” æ ¹æœ¬æ–¹æ³•å·®å¼‚:")
    print()
    
    # Pythonæ¨¡å‹ç‰¹ç‚¹
    print("1. PYTHONæ¨¡å‹ï¼ˆç ”ç©¶å¯¼å‘å‹ï¼‰:")
    print("   âœ… æ¨¡æ‹Ÿä»ç§æ¤åˆ°æ”¶è·çš„æ¯ä¸€å¤©")
    print("   âœ… è¾“å‡ºæ¯æ—¥æ—¶é—´åºåˆ—æ•°æ®ï¼ˆ365+è¡Œï¼‰")
    print("   âœ… ä¸“ä¸ºè¯¦ç»†ç ”ç©¶åˆ†æè®¾è®¡")
    print("   âœ… å®Œæ•´çš„æ—¶é—´åˆ†è¾¨ç‡")
    print()
    
    # DSSATæ¨¡å‹ç‰¹ç‚¹
    print("2. DSSAT FORTRANæ¨¡å‹ï¼ˆå†œä¸šç®¡ç†å¯¼å‘å‹ï¼‰:")
    print("   âœ… ä»…è¾“å‡ºé‡è¦ç”Ÿé•¿äº‹ä»¶")
    print("   âœ… äº‹ä»¶é©±åŠ¨å‹è¾“å‡ºï¼ˆçº¦85è¡Œï¼‰")
    print("   âœ… ä¸“ä¸ºå†œåœºç®¡ç†å†³ç­–è®¾è®¡")
    print("   âœ… å…³æ³¨å…³é”®ç‰©å€™é˜¶æ®µ")
    print()
    
    # ==================== è¾“å‡ºå¯¹æ¯”ç¤ºä¾‹ ====================
    print("ğŸ“Š å…¸å‹è¾“å‡ºå¯¹æ¯”:")
    print()
    print("Pythonæ¨¡å‹è¾“å‡ºç¤ºä¾‹:")
    print("- ç¬¬1å¤©: ç§æ¤")
    print("- ç¬¬2å¤©: å¼€å§‹å‘èŠ½")
    print("- ç¬¬3å¤©: ç»§ç»­å‘èŠ½")
    print("- ç¬¬4å¤©: ç»§ç»­å‘èŠ½")
    print("- ç¬¬5å¤©: ç»§ç»­å‘èŠ½")
    print("- ...ï¼ˆæ¯å¤©è®°å½•ï¼‰")
    print("- ç¬¬365å¤©: å­£èŠ‚ç»“æŸ")
    print("æ€»è®¡: çº¦365è¡Œ")
    print()
    
    print("DSSATæ¨¡å‹è¾“å‡ºç¤ºä¾‹:")
    print("- ç¬¬1å¤©: ç§æ¤")
    print("- ç¬¬15å¤©: å‡ºè‹—")
    print("- ç¬¬45å¤©: ç¬¬ä¸€ç‰‡å¶å±•å¼€")
    print("- ç¬¬80å¤©: å¼€å§‹å¼€èŠ±")
    print("- ç¬¬120å¤©: åæœ")
    print("- ...ï¼ˆä»…å…³é”®äº‹ä»¶ï¼‰")
    print("- ç¬¬280å¤©: æ”¶è·")
    print("æ€»è®¡: çº¦85è¡Œ")
    print()
    
    # ==================== å·®å¼‚åŸå› åˆ†æ ====================
    print("ğŸ¯ å­˜åœ¨è¿™ç§å·®å¼‚çš„åŸå› :")
    print()
    print("1. ç›®æ ‡ç”¨æˆ·:")
    print("   - Python: éœ€è¦å®Œæ•´æ—¶é—´åºåˆ—çš„ç ”ç©¶äººå‘˜")
    print("   - DSSAT: éœ€è¦å…³é”®å†³ç­–ç‚¹çš„å†œæ°‘")
    print()
    
    print("2. è®¡ç®—æ•ˆç‡:")
    print("   - Python: ä¼˜å…ˆè€ƒè™‘æ•°æ®å®Œæ•´æ€§")
    print("   - DSSAT: ä¼˜å…ˆè€ƒè™‘å¤§è§„æ¨¡æ¨¡æ‹Ÿçš„æ•ˆç‡")
    print()
    
    print("3. æ•°æ®ç”¨é€”:")
    print("   - Python: ç”¨äºç»Ÿè®¡åˆ†æã€ç»˜å›¾å’Œå»ºæ¨¡")
    print("   - DSSAT: ç”¨äºç®¡ç†å†³ç­–å’Œäº§é‡é¢„æµ‹")
    print()
    
    print("âœ… ä¸¤ç§æ–¹æ³•éƒ½æ˜¯æ­£ç¡®çš„ï¼")
    print("å®ƒä»¬æœåŠ¡äºä¸åŒçš„ç›®çš„å’Œç”¨æˆ·éœ€æ±‚ã€‚")
    print()
    
    # ==================== å®é™…æ–‡ä»¶å¯¹æ¯” ====================
    # æ£€æŸ¥æ˜¯å¦å­˜åœ¨DSSATè¾“å‡ºæ–‡ä»¶
    if os.path.exists("dssat-csm-data-develop/Strawberry/PlantGro.OUT"):
        print("ğŸ“ å®é™…æ–‡ä»¶å¯¹æ¯”:")
        try:
            # è¯»å–DSSATè¾“å‡ºæ–‡ä»¶
            with open("dssat-csm-data-develop/Strawberry/PlantGro.OUT") as f:
                lines = f.readlines()
            
            # æ‰¾åˆ°åŒ…å«æ•°æ®å¤´éƒ¨çš„è¡Œç´¢å¼•ï¼ˆä»¥@YEARå¼€å¤´çš„è¡Œï¼‰
            header_idx = next(i for i, line in enumerate(lines) if line.startswith("@YEAR"))
            
            # ä½¿ç”¨pandasè¯»å–å›ºå®šå®½åº¦æ ¼å¼æ–‡ä»¶
            dssat_df = pd.read_fwf(
                "dssat-csm-data-develop/Strawberry/PlantGro.OUT", 
                skiprows=header_idx
            )
            
            # æ‰“å°DSSATè¾“å‡ºçš„è¡Œæ•°ä¿¡æ¯
            print(f"DSSAT PlantGro.OUTæ–‡ä»¶è¡Œæ•°: {len(dssat_df)} è¡Œ")
            print("è¿™ä»…ä»£è¡¨å…³é”®ç”Ÿé•¿äº‹ä»¶")
            print()
            
        except Exception as e:
            print(f"è¯»å–DSSATè¾“å‡ºæ—¶å‡ºé”™: {e}")
    
    # ==================== éªŒè¯æ–¹æ³•è¯´æ˜ ====================
    print("ğŸ”¬ éªŒè¯æ–¹æ³•è¯´æ˜:")
    print("æˆ‘ä»¬åœ¨ç›¸åŒçš„æ—¶é—´ç‚¹æ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹")
    print("ï¼ˆä¾‹å¦‚ç¬¬50å¤©ã€ç¬¬100å¤©ç­‰ï¼‰")
    print("è¿™æ ·å¯ä»¥éªŒè¯å®ƒä»¬æ˜¯å¦äº§ç”Ÿç›¸ä¼¼çš„ç»“æœ")
    print("å°½ç®¡è¾“å‡ºé¢‘ç‡ä¸åŒã€‚")
    print()
    
    # ç»“æŸåˆ†éš”çº¿
    print("=" * 80)

if __name__ == "__main__":
    main()